const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TransferLogViewer-CUmJPIaF.js","./vendor-react-ti7DexHh.js","./HelpModal-BFGx6tg5.js"])))=>i.map(i=>d[i]);
import{u as v,_ as p}from"./index-DVXM2XNZ.js";import{r as l,j as e,S as w,b as k,X as S,H as C,P as I,B as d,F as x,e as _,f as A,g as D,h as P}from"./vendor-react-ti7DexHh.js";const B=l.lazy(()=>p(()=>import("./TransferLogViewer-CUmJPIaF.js"),__vite__mapDeps([0,1]),import.meta.url).then(n=>({default:n.TransferLogViewer}))),E=l.lazy(()=>p(()=>import("./HelpModal-BFGx6tg5.js"),__vite__mapDeps([2,1]),import.meta.url).then(n=>({default:n.HelpModal})));function R({onClose:n}){const{settings:g,updateSettings:m}=v(),[r,a]=l.useState(g),[c,b]=l.useState(null),[o,f]=l.useState("general"),[j,h]=l.useState(!1);l.useEffect(()=>{(async()=>{const s=await window.electronAPI.getSettings();a(s)})()},[]);const y=()=>{window.electronAPI.updateSettings(r).then(s=>{m(s),n()})},N=async()=>{const s=await window.electronAPI.resetSettings();a(s),m(s)},u=async s=>{const t=await window.electronAPI.validatePath(s,"directory");b(t)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-10 flex items-center justify-center z-10",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-[90vw] sm:max-w-xl md:max-w-2xl lg:max-w-4xl xl:max-w-5xl max-h-[85vh] overflow-hidden shadow-l flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-1 electron-drag",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(w,{className:"w-5 h-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"设置"})]}),e.jsxs("div",{className:"flex items-center space-x-4 electron-no-drag -ml-3",children:[e.jsx("button",{onClick:()=>h(!0),className:"w-5 h-5 hover:bg-gray-100",title:"使用帮助",children:e.jsx(k,{className:"w-5 h-5 text-gray-600"})}),e.jsx("button",{onClick:n,className:"w-8 h-8 hover:bg-gray-100",title:"关闭",children:e.jsx(S,{className:"w-8 h-8 text-gray-600"})})]})]}),e.jsxs("div",{className:"flex border-b px-3 ",children:[e.jsx("button",{onClick:()=>f("general"),className:`px-3 py-2 text-lg font-medium border-b-2 transition-colors ${o==="general"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"常规设置"}),e.jsxs("button",{onClick:()=>f("logs"),className:`px-3 py-2 text-lg font-medium border-b-2 transition-colors flex items-center justify-center ${o==="logs"?"border-blue-500 text-blue-900":"border-transparent text-gray-900 hover:text-gray-900"}`,children:[e.jsx(C,{className:"w-4 h-4 inline mr-1"}),"传输日志"]})]}),e.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-1 leading-tight",children:[o==="general"&&e.jsxs("div",{className:"space-y-1 p-3 leading-tight",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[e.jsx(I,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"开机自动启动"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.autoStart,onChange:s=>a(t=>({...t,autoStart:s.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx(d,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"传输完成通知"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.notifications,onChange:s=>a(t=>({...t,notifications:s.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx(x,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"iOS 应用 Bundle ID"})]}),e.jsx("div",{className:"flex items-center space-x-1.5",children:e.jsx("input",{value:r.iosBundleId||"",onChange:s=>{const t=s.target.value;a(i=>({...i,iosBundleId:t}))},placeholder:"例: com.example.app",className:"flex-1 min-w-0 px-3 py-2 rounded border border-gray-300 focus:outline-none"})}),e.jsx("div",{className:"text-xs text-gray-500",children:"用于定位应用容器，例如 com.tencent.uc"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx(x,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"设备轮询间隔 (毫秒)"})]}),e.jsx("div",{className:"flex items-center space-x-1.5",children:e.jsx("input",{type:"number",value:Number(r.pollingInterval||0)||5e3,onChange:s=>{const t=parseInt(s.target.value||"0",10);a(i=>({...i,pollingInterval:isNaN(t)?5e3:t}))},placeholder:"例如 5000",className:"flex-1 min-w-0 px-3 py-2 rounded border border-gray-300 focus:outline-none"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx(d,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"监控 Android 设备"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.enableADB!==!1,onChange:s=>a(t=>({...t,enableADB:s.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx(d,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"监控 iOS 设备"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.enableIOS!==!1,onChange:s=>a(t=>({...t,enableIOS:s.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx(x,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"轮询失败最大重试次数"})]}),e.jsx("div",{className:"flex items-center space-x-1.5",children:e.jsx("input",{type:"number",value:Number(r.maxRetries||0)||3,onChange:s=>{const t=parseInt(s.target.value||"0",10);a(i=>({...i,maxRetries:isNaN(t)?3:t}))},placeholder:"例如 3",className:"flex-1 min-w-0 px-3 py-2 rounded border border-gray-300 focus:outline-none"})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[e.jsx(_,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"文件保存目录"})]}),e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx("input",{value:r.saveDir||"",onChange:s=>{const t=s.target.value;a(i=>({...i,saveDir:t})),u(t)},placeholder:"选择文件保存目录",className:`flex-1 min-w-0 px-3 py-2 rounded border ${c?c.valid?"border-green-500":"border-red-500":"border-gray-300"} focus:outline-none truncate`}),e.jsx("button",{onClick:async()=>{const s=await window.electronAPI.selectDirectory();s&&(a(t=>({...t,saveDir:s})),u(s))},className:"px-3 py-1.5 text-sm bg-gray-100 rounded hover:bg-gray-200",children:"浏览"}),c&&(c.valid?e.jsx(A,{className:"w-5 h-5 text-green-600"}):e.jsx(D,{className:"w-5 h-5 text-red-600"}))]}),c&&!c.valid&&e.jsx("div",{className:"text-xs text-red-600",children:c.error})]})]}),o==="logs"&&e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"p-3 text-gray-600",children:"加载日志..."}),children:e.jsx(B,{onClose:n})})]}),o==="general"&&e.jsxs("div",{className:"flex justify-between p-3 border-t bg-gray-50",children:[e.jsxs("button",{onClick:N,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors flex items-center space-x-1.5",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{children:"恢复默认"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:n,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"取消"}),e.jsx("button",{onClick:y,className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors",children:"保存"})]})]}),j&&e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"p-4 text-gray-600",children:"加载帮助..."}),children:e.jsx(E,{onClose:()=>h(!1)})})]})})}export{R as SettingsModal};
